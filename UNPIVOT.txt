=LAMBDA(row_labels,values,delMtr,[col_labels],[scan_by_col],[headers],LET(valTXT,LAMBDA(array,delimiter,LET(n,(LEN(array)-LEN(SUBSTITUTE(array,delimiter,)))/LEN(delimiter),m,MAX(n)+1,TEXTBEFORE(TEXTAFTER(delimiter&array&REPT(delimiter,m-n),delimiter,SEQUENCE(,m)),delimiter))),i,IF(ISOMITTED(row_labels),SEQUENCE(ROWS(valTXT(values,delMtr))),row_labels),j,IF(ISOMITTED(col_labels),SEQUENCE(,COLUMNS(valTXT(values,delMtr))),col_labels),w,COLUMNS(i),h,ROWS(j),t,valTXT(values,delMtr)<>"",λ,LAMBDA(x,TOCOL(IFS(t,x),2,scan_by_col)),a,HSTACK(IF(w=1,λ(i),CHOOSEROWS(i,λ(SEQUENCE(ROWS(i))))),IF(h=1,λ(j),CHOOSEROWS(TRANSPOSE(j),λ(SEQUENCE(,COLUMNS(j))))),λ(valTXT(values,delMtr))),IF(TYPE(headers)=64,VSTACK(TOROW(headers),a),IF(headers,VSTACK(HSTACK(IF(ISOMITTED(row_labels),"RowID","Field"&SEQUENCE(,w)),IF(ISOMITTED(col_labels),"ColumnID","Attribute"&SEQUENCE(,h)),"Value"),a),a))))